Suit={Components:{}},Suit.Helpers={toUnderscoredObject:function(a){var b=this;return _.isArray(a)&&_.isObject(a)&&a.length>0&&_.isObject(a[0])?_.each(a,function(c,d){a[d]=b.toJSON.apply(b,[c])}):_.isObject(a)&&!_.isArray(a)&&_.each(_.keys(a),function(c){var d=a[c],e=_.str.underscored(c);a[c]&&delete a[c],a[e]=_.isObject(d)?b.toJSON.apply(b,[d]):d}),a},toJSON:function(a){return this.toUnderscoredObject(a)},toCamelCaseObject:function(a){var b=this;return _.isArray(a)&&_.isObject(a)&&a.length>0&&_.isObject(a[0])?_.each(a,function(c,d){a[d]=b.toCamelCaseObject.apply(b,[c])}):_.isObject(a)&&!_.isArray(a)&&_.each(_.keys(a),function(c){var d=a[c],e=_.str.camelize(c);delete a[c],a[e]=_.isObject(d)?b.toCamelCaseObject.apply(b,[d]):d}),a},convertToUtf8:function(a){var b=a;return _.isString(b)?(b=b.replace(/[\u2018]/g,"'"),b=b.replace(/[\u2019]/g,"'"),b=b.replace(/[\u201A]/g,"'"),b=b.replace(/[\u201C]/g,'"'),b=b.replace(/[\u201D]/g,'"'),b=b.replace(/[\u201E]/g,'"'),b=b.replace(/\u2026/g,"..."),b=b.replace(/[\u2013]/g,"-"),b=b.replace(/[\u2014]/g,"-"),b=b.replace(/\u02C6/g,"^"),b=b.replace(/\u2039/g,"<"),b=b.replace(/\u203A/g,">"),b=b.replace(/[\u02DC]/g," "),b=b.replace(/[\u00A0]/g," ")):b}},Suit.Helpers.Formatters=_.extend(_.str,{formatDate:function(a){return _.isUndefined(a)||""===a?"":moment(a).format("MM/DD/YYYY")},formatNumber:function(a){return _.isUndefined(a)||null===a?String(0):(a%1!==0&&(a=parseFloat(a).toPrecision(3),0===String(a).indexOf("0.")&&(a=parseFloat(a).toFixed(2))),String(a).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))},formatNumberPercentage:function(a){return Suit.Helpers.Formatters.formatNumber(a)+"%"},formatNumberOneDecimal:function(a){return _.isUndefined(a)||null===a?String(0):(a%1!==0&&(a=parseFloat(a).toPrecision(3),a=parseFloat(a).toFixed(1)),String(a).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))},abbreviateNumberNoDecimal:function(a){if(_.isNull(a)||isNaN(a))return"0";var b=!0;return 0>a&&(a=-1*a,b=!1),a>=1e9?(a/=1e9,b?Math.round(a)+"B":-1*Math.round(a)+"B"):a>=1e6?(a/=1e6,b?Math.round(a)+"MM":-1*Math.round(a)+"MM"):a>=1e3?(a/=1e3,b?Math.round(a)+"K":-1*Math.round(a)+"K"):String(b?Math.round(a):-1*Math.round(a))},abbreviateNumber:function(a){return _.isNull(a)||isNaN(a)?"0":a>=1e9?(a/=1e9,Suit.Helpers.Formatters.formatNumber(a)+"B"):a>=1e6?(a/=1e6,Suit.Helpers.Formatters.formatNumber(a)+"MM"):a>=1e3?(a/=1e3,Suit.Helpers.Formatters.formatNumber(a)+"K"):Suit.Helpers.Formatters.formatNumber(a)},extractNumbersFromString:function(a){return a&&a.match(/\d+\.?\d*/g)?a.match(/\d+\.?\d*/g).join(""):0/0},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},secondsToString:function(a){var b=moment.duration(a,"seconds"),c="",d=b.hours(),e=("0"+b.minutes()).slice(-2),f=("0"+b.seconds()).slice(-2);return d>0&&(d=("0"+d).slice(-2),c+=d+":"),c+=e+":",c+=f},prepend:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return b+" "+a.join(" ")},append:function(){var a=Array.prototype.slice.call(arguments),b=a.shift();return a.join(" ")+" "+b},replace:function(a,b,c){return String(a).replace(b,c)},convertApiURL:function(a){if(a=String(a).split("/api/"),a=a.length>1?a[a.length-1]:!1,a===!1)throw"Not a valid API url";return"#"+a.replace("_advertiser","advertiser")},lowercase:function(a){return String(a).toLowerCase()},uppercase:function(a){return String(a).toUpperCase()},pluralize:function(){return _.pluralize.apply(_,arguments)},singularize:function(){return _.singularize.apply(_,arguments)},gsub:function(){return _.gsub.apply(_,arguments)},ordinalize:function(){return _.ordinalize.apply(_,arguments)}}),Suit.RestfulUrls={_restfulBase:function(){var a=_.result(this,"urlRoot");return _.isUndefined(a)&&(a=_.result(this,"url"),a=a.substr(0,a.lastIndexOf("/"))),"#"+a.replace("/api/","").replace("_advertiser","advertiser")},showUrl:function(){return this._restfulBase.apply(this)+"/"+this.id},newUrl:function(){return this._restfulBase.apply(this)+"/new"},editUrl:function(){return this._restfulBase.apply(this)+"/"+this.id+"/edit"},deleteUrl:function(){return this._restfulBase.apply(this)+"/"+this.id}};var backBoneSync=Backbone.sync;Backbone.sync=function(a,b,c){c=c||{};var d=c.success,e=c.originalEvent;if(e&&"submit"===e.type){var f=$(e.srcElement);f&&f.is("form")&&(c.type=e.type=f.attr("method")?f.attr("method"):"GET")}var g=a;switch(a){case"read":g=a;break;case"patch":g="patched";break;default:g=a+"d"}c.success=function(a,e,f){d&&(d(a,e,f),b.trigger(g,b,a,c))},_.contains(_.functions(b),"saveToLocalStorage")&&b.saveToLocalStorage(g),(_.isUndefined(b.remoteStorage)||b.remoteStorage===!0)&&backBoneSync(a,b,c)},Suit.LocalStorage={saveToLocalStorage:function(a){if(this.localStorage&&!_.isUndefined(this.className)){var b=this.className+this.id;if("deleted"!==a){var c=JSON.parse(localStorage.getItem(b));_.isObject(c)||(c={});var d=this.attributes;_.each(d,function(a,b){c[b]=a}),localStorage.setItem(b,JSON.stringify(c))}else localStorage.removeItem(b)}},loadFromLocalStorage:function(a){if(this.localStorage&&!_.isUndefined(this.className)){var b=this.className+this.id,c=localStorage.getItem(b);if(this.localStorage&&(a||this.id&&1===_.size(this.attributes)&&!_.isNull(c))){var d=this;this.attributes=JSON.parse(c),this.trigger("change"),_.each(c,function(a){d.trigger("change:"+a)})}}}},Suit.Validation={patterns:{email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i},validatorMessages:{required:"{attr} is required.",email:"{attr} is not an e-mail address.",minLengthPass:"{attr} needs to be at least 6 characters long.",min:"{attr} needs to be at least {min} characters long.",max:"{attr} needs to be less than {max} characters long.",range:"{attr} needs to be between {min} and {max}.",dateTime:"The date and time you introduced was not valid. We like format YYYY/MM/DD HH:MM.",inclusion:"{attr} value in not included in the list of values.",confirmation:"{attr} and it's confirmation field do not match.",numeric:"{attr} value must be numeric."},validators:{required:function(a,b){return _.isNull(b)||_.isUndefined(b)||_.isString(b)&&""===b.trim()||_.isArray(b)&&_.isEmpty(b)?this.validatorMessages.required.replace("{attr}",_.str.capitalize(a)):void 0},email:function(a,b){return _.str.isBlank(b)||_.isString(b)&&b.match(this.patterns.email)?void 0:this.validatorMessages.email.replace("{attr}",_.str.capitalize(a))},min:function(a,b,c){return!_.isString(b)||b.length<c?this.validatorMessages.min.replace("{attr}",_.str.capitalize(a)).replace("{min}",c.toString()):void 0},max:function(a,b,c){return!_.isString(b)||b.length>c?this.validatorMessages.max.replace("{attr}",_.str.capitalize(a)).replace("{max}",c.toString()):void 0},range:function(a,b,c){return!_.isString(b)||b.length<c[0]||b.length>c[1]?this.validatorMessages.range.replace("{attr}",_.str.capitalize(a)).replace("{min}",c[0].toString()).replace("{max}",c[1].toString()):void 0},minLengthPass:function(a,b){return!_.isUndefined(b)&&b.length<6?this.validatorMessages.minLengthPass.replace("{attr}",_.str.capitalize(a)):void 0},inclusion:function(a,b,c){return _.isUndefined(b)||_.contains(c,b)?void 0:this.validatorMessages.inclusion.replace("{attr}",_.str.capitalize(a))},confirmation:function(a,b){var c=this.get(a+"Confirmation");return b&&c!==b?this.validatorMessages.confirmation.replace("{attr}",_.str.capitalize(a)):void 0},numeric:function(a,b){return!b&&0!==b||(b=parseFloat(b),_.isNumber(b)&&!_.isNaN(b))?void 0:this.validatorMessages.numeric.replace("{attr}",_.str.capitalize(a))}},validate:function(a){var b=this,c=_.extend({},b.attributes,a),d=this.validateModel(c);return _.defer(function(){b.trigger("validated",d.isValid,b,d.invalidAttrs)}),d.isValid?void 0:d.invalidAttrs},validateModel:function(a){var b=this,c={},d=!0;return _.each(b.validates,function(e,f){var g=b.validateAttr(f,a[f]);g&&!_.isEmpty(g)&&(d=!1,c[f]=g)}),{invalidAttrs:c,isValid:d}},validateAttr:function(a,b){var c=this,d=this.validates[a].rules,e=[];return _.each(d,function(d){var f=!1,g=[a,b];c.validates[a][d]&&g.push(c.validates[a][d]),c.validators[d]?f=c.validators[d].apply(c,g):_.isFunction(c[d])&&(f=c[d].apply(c,g)),f&&""!==f.trim()&&e.push(f)}),e}},Suit.Model=Backbone.RelationalModel.extend({initialize:function(){},dateAttrs:[],dateFormat:"YYYY-MM-DD HH:mm:ss",parse:function(a){return a=Suit.Helpers.toCamelCaseObject.apply(Suit.Helpers,[a])},toJSON:function(){var a=Backbone.RelationalModel.prototype.toJSON.call(this);return a=Suit.Helpers.toJSON.apply(Suit.Helpers,[a])},get:function(a){this.loadFromLocalStorage();var b=Backbone.RelationalModel.prototype.get.call(this,a);return!_.contains(this.dateAttrs,a)||_.isUndefined(b)||_.isEmpty(b)?b:moment(b)},convertToMoment:function(a,b){return!_.isEmpty(this.dateAttrs)&&_.contains(this.dateAttrs,b)&&(_.isUndefined(a)||_.isNull(a)||""===a?a="":(_.isString(a)&&(a=new Date(a)),a=moment(a).format(this.dateFormat))),a},set:function(){var a,b,c=this,d=arguments[0];return _.isObject(d)?(b=arguments[1],_.each(d,function(a,b){a=Suit.Helpers.convertToUtf8(a),a=c.convertToMoment(a,b),d[b]=a}),Backbone.RelationalModel.prototype.set.call(this,d,b)):(a=arguments[1],b=arguments[2],a=Suit.Helpers.convertToUtf8(a),a=this.convertToMoment(a,d),Backbone.RelationalModel.prototype.set.call(this,d,a,b))}}),_.extend(Suit.Model.prototype,Suit.LocalStorage,Suit.Validation,Suit.RestfulUrls),Suit.Collection=Backbone.Collection.extend({initialize:function(){},sortBy:"id",sortOrder:"asc",model:Suit.Model,comparator:function(a,b){if(!_.isEmpty(this.sortBy)&&!_.isEmpty(this.sortOrder)){var c=this.sortBy.split(":"),d=c[0],e=c[1];return _.isUndefined(e)?(a=a.get(d),b=b.get(d)):(a=a[e](),b=b[e]()),_.isString(a)&&(a=a.toLowerCase()),_.isString(b)&&(b=b.toLowerCase()),"asc"===this.sortOrder?a>b?1:b>a?-1:0:a>b?-1:b>a?1:0}}}),_.extend(Suit.Collection.prototype,Suit.RestfulUrls),Suit.View=Backbone.View.extend({initialize:function(a){this.viewData={},a=_.isObject(a)?a:{},this.options=_.isObject(this.options)?this.options:{},this.options=_.extend(this.options,a),this.components={},this.setParent(this.options.parent),this.children=this.options.children||[],_.isUndefined(this.options.model)||(this.model=this.options.model,this.listenTo(this.model,"request",this.cleanErrors),this.listenTo(this.model,"error",this.handleErrors),this.listenTo(this.model,"validated",this.handleValidation)),this.events=_.result(this,"events")||{},this.events=_.extend({"mouseover .error":function(a){var b=$(a.currentTarget),c=b.attr("data-error-key");b.is(".select-box")&&(c=b.find("select").attr("data-error-key"));var d=$("body").find('.tooltip[data-error-key="'+c+'"]');d.css({top:b.offset().top-d.height()-12,left:b.offset().left}).show()},"mouseout .error":function(a){var b=$(a.currentTarget),c=b.attr("data-error-key");b.is(".select-box")&&(c=b.find("select").attr("data-error-key")),$("body").find('.tooltip[data-error-key="'+c+'"]').hide()}},this.events);var b=this;_.bindAll(this,"render"),this.render=_.wrap(this.render,function(a){return b._beforeRender(),b.trigger("onRender"),a(),b._afterRender(),b}),_.bindAll(this,"close"),this.close=_.wrap(this.close,function(a){return b._beforeClose(),b.trigger("onClose"),a(),b._afterClose(),b}),App.currentUser&&this.listenTo(App.currentUser,"change:permission",this._removeUnauthorizedElements),this.errors=[],this.$el.data("view",this)},formatters:Suit.Helpers.Formatters,cleanErrors:function(){for(this.$el.find(".error").removeClass("error");this.errors.length;){var a=this.errors.pop();a.remove()}},handleErrors:function(a,b){var c=this;if(!_.isUndefined(b)&&(400===b.status||422===b.status)){var d=JSON.parse(b.responseText);_.each(d,function(a,b){c.showVisualError(b,a)})}},handleValidation:function(a,b,c){var d=this;this.cleanErrors(),a||_.each(c,function(a,b){d.showVisualError(b,a)})},showVisualError:function(a,b){var c=_.str.underscored(a),d=this.$el.find('[name="'+a+'"], [data-name="'+a+'"], [name="'+c+'"], [data-name="'+c+'"]');if(d.length>0){"select-one"===d.prop("type")?d.parent().addClass("error"):d.addClass("error"),d.attr("data-error-key",a);var e=_.isArray(b)?b.join("<br />"):b,f=$('<div class="tooltip" data-error-key="'+a+'"><div class="tooltip-content">'+e+'</div><div class="tooltip-arrow"></div></div>');this.errors.append(f),$("body").append(f)}},setParent:function(a){this.parent=a,_.isUndefined(this.parent)||(this.parent.children.push(this),this.parent.children=_.uniq(this.parent.children),this.listenTo(this.parent,"onClose",this.close))},setChild:function(a){a.setParent(this)},find:function(a){return _.isUndefined(a)?this.$el:this.$el.find(a)},findClosestParentView:function(a){var b=this.find(a);if(b===this.$el)return this;if(_.isUndefined(b.data("view"))){var c=_.find(b.parents(),function(a){return!_.isUndefined($(a).data("view"))});return _.isUndefined(c)?void 0:$(c).data("view")}return b.data("view")},appendView:function(a,b){var c=this.findClosestParentView(b),d=this.find(b);return a.setParent(c),d.append(a.el),a.render(),this},prependView:function(a,b){var c=this.findClosestParentView(b),d=this.find(b);return a.setParent(c),d.prepend(a.el),a.render(),this},htmlView:function(a,b){return this.empty(b),this.appendView(a,b),this},noData:function(a){var b=this.find(a);if(0===b.find(".no-data").length){var c=b.parent(),d=b.outerHeight(),e=b.outerWidth(),f=$('<div class="no-data bgc-light-grey p-absolute ta-center fs-20"></div>');c.data("original-position",c.css("position")),c.css("position","relative"),f.html("Ø NO DATA FOR SELECTED TIMEFRAME"),f.css("line-height",d+"px"),f.css("vertical-align","middle"),f.css("width",e+"px"),f.css("height",d+"px"),f.css("top",0),f.css("left",0),b.append(f)}},removeNoData:function(a){var b=this.find(a),c=b.parent(),d=b.find(".no-data");d.remove(),c.css("position",c.data("original-position"))},loader:function(a){var b;b=a&&a.selector?this.find(a.selector):this.$el;var c=b.parent(),d=b.outerHeight(),e=b.outerWidth(),f=$('<div class="loader"></div>');a&&"small"===a.loaderSize&&f.addClass("small"),a&&"light"===a.tone&&f.addClass("light"),c.data("original-position",c.css("position")),c.css("position","relative"),f.css("width",e+"px"),f.css("height",d+"px"),f.css("top",0),f.css("left",0),b.append(f)},removeLoader:function(a){var b=this.find(a),c=b.parent(),d=b.find(".loader");d.remove(),c.css("position",c.data("original-position"))},empty:function(a){this.closeChildren(a),this.find(a).empty()},findChildrenBySelector:function(a){if(!_.isUndefined(a)){var b=this.findClosestParentView(a);if(!_.isUndefined(b)){var c=b.find(a).get(0);return _.filter(b.children,function(a){return a.$el===c||_.contains(a.$el.parents(),c)})}}return this.children},closeChildren:function(a){for(var b=this.findChildrenBySelector(a),c=b.length-1;c>=0;c--)b[c].close()},_beforeClose:function(){if(this._rivets&&this._rivets.unbind(),this.$(".error").off("hover"),this.trigger("beforeClose"),this.beforeClose(),!_.isUndefined(this.parent)){var a=this.parent.children.indexOf(this);a>=0&&this.parent.children.splice(a,1),this.parent=void 0}this.trigger("onClose"),this.unbind(),_.isUndefined(this.$el)||this.$el.unbind(),_.isUndefined(this.$el)||_.each(this.$el.find("*"),function(a){a=$(a),a.unbind(),a.remove()})},beforeClose:function(){},close:function(a){a instanceof Event&&a.preventDefault(),_.isUndefined(this.$el)?this.stopListening():this.remove(),_.isUndefined(this.$el)||delete this.$el,delete this.el},_afterClose:function(){this.trigger("afterClose"),this.afterClose()},afterClose:function(){},_beforeRender:function(){this.trigger("beforeRender"),this.beforeRender()},beforeRender:function(){},render:function(){return this.template&&(this.empty(),this.$el.html(this.template(this))),this},initRivets:function(){this._rivets&&this._rivets.unbind(),this._rivets=window.rivets.bind(this.el,this)},_afterRender:function(){var a=this;this.initializeComponents(),this._removeUnauthorizedElements(),this.initRivets();var b=a.find("input[autofocus]:first");_.isEmpty(b)||_.defer(function(){b.focus()}),a.trigger("afterRender"),a.afterRender()},_removeUnauthorizedElements:function(){if(App.currentUser&&this.el){var a=this,b=this.find("[data-permissions]"),c=App.currentUser.get("permission");_.each(b,function(b){b=$(b);var d=b.attr("data-permissions").replace(/ /g,"").split(",");if(!_.contains(d,c)){var e=b.data("view");e?e.close():(a.empty(b),b.remove())}})}},afterRender:function(){},initializeComponents:function(){var a=this;_.each(Suit.Components.registeredComponents,function(b){var c=a.$el.find("."+_.str.dasherize(b).slice(1));c.length>0&&_.each(c,function(c){var d=$(c).data("view");if(_.isUndefined(d)){var e=new Suit.Components[b]({el:c});e.setParent(a)}else d.setParent(a)})})},serializeObject:function(a){a=a||"form";var b={},c=this.find(a+" :input").serializeArray();return $.each(c,function(){var a=_.str.camelize(this.name);b[a]?(b[a].push||(b[a]=[b[a]]),b[a].push(this.value||"")):b[a]=this.value||""}),b}});var Controller=Suit.Controller=function(a){a=a||{},this.initialize.apply(this,arguments)},Events=Backbone.Events;_.extend(Controller.prototype,Events,{initialize:function(){var a=this,b=_.without(_.functions(this),"goBack");_.each(b,function(b){var c=_.functions(Events);_.zip(c,["initialize","constructor"]),_.contains(c,b)||(a[b]=_.wrap(a[b],function(c){return Suit.Can.go(a.className,b)?c.apply(a,Array.prototype.slice.call(arguments,1)):void 0}))})},setTitle:function(a){window.document.title="SET - "+a},goBack:function(a,b){a=a||null,b=_.isUndefined(b)?!0:b;var c=App.routesHistory.previousRoute;c?Backbone.history.navigate(c,{trigger:b}):a?Backbone.history.navigate(a,{trigger:b}):Backbone.history.navigate("",{trigger:b})}}),Controller.extend=Backbone.Model.extend;var Cache=Suit.Cache=function(a){a=a||{},this.initialize.apply(this,arguments)},Events=Backbone.Events;_.extend(Cache.prototype,Events,{initialize:function(){},getData:function(){return this.data=this.data||{},this.data},set:function(a,b){var c=this.getData();c[a]={value:b,timestamp:moment().utc()}},get:function(a){var b=this.getData();this.expired(a)&&delete b[a];var c=b[a];return _.isUndefined(c)?void 0:c.value},expired:function(a){var b=this.getData();return!_.has(b,a)||this.expirationRule(a)?!0:!1},expirationRule:function(a){return a===!1}}),Cache.extend=Backbone.Model.extend,Suit.Router=Backbone.Router.extend({initialize:function(){this.on("all",this.storeRoute)},storeRoute:function(){App.routesHistory.currentRoute!==Backbone.history.fragment&&(App.routesHistory.previousRoute=App.routesHistory.currentRoute,App.routesHistory.currentRoute=Backbone.history.fragment)},_extractParameters:function(a,b){for(var c=/([^&=]+)=?([^&]*)/g,d=function(a){return decodeURIComponent(a.replace(/\+/g," "))},e=function(a){if(a&&_.contains(a,"=")){var b,e={};for(b=c.exec(a);b;){var f=d(b[1]),g=d(b[2]);void 0!==e[f]?($.isArray(e[f])||(e[f]=[e[f]]),e[f].push(g)):e[f]=g,b=c.exec(a)}return Suit.Helpers.toCamelCaseObject(e)}return a},f=a.exec(b).slice(1),g=f.length-1;g>=0;g--)f[g]=e(f[g]);return f.length>1?f.slice(0,-1):f},route:function(a,b,c){var d=this,e=d.className,f=App.Controllers[e],g=d;c=c||d[b],f&&(c=f[b],g=f);var h=function(){var a=function(a){d.beforeEach&&d.beforeEach.apply(d,a),c=c||d[b],c.apply(g,a),d.afterEach&&d.afterEach.apply(d,a)},e=/^[#\/]|\s+$/g,h=Backbone.history.fragment;h=h.replace(e,"");var i=Backbone.history.handlers,j=_.find(i,function(a){return a.route.test(h)?!0:void 0});window.document.title=_.str.humanize(b),Suit.Components.Modal.closeAll();var k=d._extractParameters(j.route,h);if(App.currentRouter!==d)return App.currentRouter=d,void(_.isUndefined(Backbone.history.firstLoad)||Backbone.history.firstLoad?(Backbone.history.firstLoad=!1,App.mainRouter.beforeAll.apply(App.mainRouter,k),a(k),App.mainRouter.afterAll.apply(App.mainRouter,k)):a(k));var l=d.className;return _.has(App.Controllers,l)&&_.contains(_.functions(App.Controllers[l]),b)?(f[b].apply(f,k),!1):void a(k)};return Backbone.Router.prototype.route.call(d,a,b,h)}});var Can=function(a){a=a||{},this.initialize.apply(this,arguments)},Events=Backbone.Events;_.extend(Can.prototype,Events,{initialize:function(){},go:function(a,b){var c,d=App.currentUser;try{var e=App.canRules,f=e[a]||{};if(c=f[b]||{},c.requireLogin!==!1&&(f.requireLogin!==!1||c.requireLogin)&&(e.requireLogin!==!1||f.requireLogin||c.requireLogin)&&!this.authenticate())return!1;if(!c||!c.permissions)return!0}catch(g){return!0}var h=c.permissions;return _.contains(h,d.get("permission"))?!0:!1},authenticate:function(){return _.isNull(localStorage.getItem("token"))?(App.Controllers.Sessions.logout(),!1):(_.isNull(App.currentUser)&&(App.currentUser=App.Models.User.find({token:localStorage.getItem("token")})||App.Models.User.findOrCreate({token:localStorage.getItem("token")})),App.currentUser.isNew()&&App.currentUser.fetchMe(),!0)}}),Can.extend=Backbone.Model.extend,Suit.Can=new Can,Suit.Components=Suit.Components||{},Suit.Components.Binders=Suit.Components.Binders||{},Suit.Components.registeredComponents=[],Suit.Components.registerComponent=function(a){a=_.str.classify(_.str.underscored(a)),Suit.Components.registeredComponents.push(a),Suit.Components.registeredComponents=_.uniq(Suit.Components.registeredComponents)},Suit.Components.Binders["component-*"]={block:!0,bind:function(){var a,b=$(this.el),c=b.attr("id"),d=_.str.camelize(_.str.underscored(this.args[0])),e=_.str.classify(_.str.underscored(d)),f={},g=this;_.each(b.data(),function(a,b){_.str.startsWith(b,d)&&(f[b]=a)}),a={el:this.el},_.each(f,function(b,c){var e=b.split(":"),f=g.view.models[e.shift()],h=f;f&&e.length>0&&(h=g.view.adapters[":"].read(f,e.join(":"))),a[_.str.camelize(_.str.underscored(c.replace(d,"")))]=h||b}),this.componentView=new Suit.Components[e](a),b.removeAttr("suit-component-"+d),this.componentView.setParent(this.view.models),this.componentView.render(),b.attr("suit-component-"+d),c&&(this.view.models.components[c]=this.componentView)},unbind:function(){this.componentView.close()},routine:function(){}},_.extend(window.rivets.binders,Suit.Components.Binders),Suit.Component=Suit.View.extend({initialize:function(a){Suit.View.prototype.initialize.apply(this,[a])}}),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Alert=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]),this.type=this.options.type||"information",this.message=this.options.message||"Suit alert box!",this.listenTo(Backbone.history,"route",this.close)},className:function(){return"alert-box-set-"+this.type},tagName:"a",attributes:{href:"javascript:void(0);"},template:JST["suit/components/alert"],events:{click:"close"},message:"Suit alert box!",type:"information",alertIcon:"i"}),Suit.Components.ConfirmationAlert=Suit.Components.Alert.extend({className:"alert-box-confirmation",alertIcon:"c",afterRender:function(){var a=this;this.$el.delay(2e3).fadeOut("slow",function(){a.close()})}}),Suit.Components.ErrorAlert=Suit.Components.Alert.extend({className:"alert-box-error",alertIcon:"e"}),Suit.Components.WarningAlert=Suit.Components.Alert.extend({className:"alert-box-warning",alertIcon:"a"}),Suit.Components.InformationAlert=Suit.Components.Alert.extend({className:"alert-box-information",alertIcon:"i"}),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Confirm=Suit.Component.extend({initialize:function(a){this.title=a.title||"Confirm",this.text=a.text||"Are you sure?",this.color=a.color||"blue",Suit.Component.prototype.initialize.apply(this,[a]),this.modal=new Suit.Components.Modal({view:this,size:"small",persistent:!0}),this.modal.show()},template:JST["suit/components/confirm"],events:{"click button.yes":"defaultSuccess","click .no":"defaultCancel"},defaultSuccess:function(a){a.preventDefault(),a.stopPropagation(),this.options.success&&_.isFunction(this.options.success)&&this.options.success.call(this),this.modal.close()},defaultCancel:function(a){a.preventDefault(),a.stopPropagation(),this.options.cancel&&_.isFunction(this.options.cancel)&&this.options.cancel.call(this),this.modal.close()}}),Suit.Components.registerComponent("Confirm"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.DatePicker=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]);var b=this,c={defaultDate:this.$el.data("dp-default-date"),setDefaultDate:this.$el.data("dp-set-default-date"),firstDay:this.$el.data("dp-first-day"),minDate:this.$el.data("dp-min-date"),maxDate:this.$el.data("dp-max-date")};c=_(c).reduce(function(a,b,c){return b&&(a[c]=b),a},{});var d={field:this.$el.find("input")[0],format:"MM/DD/YYYY",onSelect:function(){b.trigger("selected")},onOpen:function(){b.openPicker(b)},onClose:function(){b.closePicker(b)},i18n:{previousMonth:"<",nextMonth:">",months:["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}};_.extend(c,d),this.picker=new Pikaday(c);var e=this.$el.attr("class").split(" ")[1]||"blue";$(this.picker.el).addClass(e),this.$el.hasClass("disabled")&&(e="blue",this.$el.find("a").addClass("disabled"),this.$el.find("input").attr("disabled","disabled"))},events:{"click .date-picker-trigger":"showPicker"},openPicker:function(a){a.$el.addClass("active")},closePicker:function(a){a.$el.removeClass("active")},showPicker:function(a){a.preventDefault(),$(a.currentTarget).hasClass("disabled")||this.picker.show()},beforeClose:function(){var a=$(this.picker.el);a.unbind(),a.remove()}}),Suit.Components.registerComponent("DatePicker"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.DateRange=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]);var b=this;this.sequencial=this.$el.data("dr-sequencial")||!1,this.startPicker=this.$el.find(".date-picker-start").data("view"),this.endPicker=this.$el.find(".date-picker-end").data("view"),this.listenTo(this.startPicker,"selected",function(){_.defer(function(){b.selectedStart(),b.trigger("change:start"),b.$el.trigger("change:start")})}),this.listenTo(this.endPicker,"selected",function(){b.find("select").val("custom"),b.trigger("change:end"),b.$el.trigger("change:end")})},events:{"change select":"predefinedSelected"},selectedStart:function(){this.sequencial&&this.startPicker&&this.startPicker.find&&this.endPicker.picker.setMinDate(new Date(this.startPicker.find("input").val())),this.endPicker.find("input").focus(),this.find("select").val("custom"),this.trigger("change"),this.$el.trigger("change")},predefinedSelected:function(a){a.preventDefault();var b=$(a.target).val();switch("all"!==b&&this.startPicker.find("input").attr("placeholder","yyyy/mm/dd"),b){case"custom":this.startPicker.find("input").val("").focus(),this.endPicker.find("input").val("");break;case"today":this.startPicker.picker.setMoment(moment(),!0),this.endPicker.picker.setMoment(moment(),!0);break;case"last_7_days":this.startPicker.picker.setMoment(moment().subtract(7,"days"),!0),this.endPicker.picker.setMoment(moment(),!0);break;case"this_month":this.startPicker.picker.setMoment(moment().date(1),!0),this.endPicker.picker.setMoment(moment(),!0);break;case"this_quarter":this.startPicker.picker.setMoment(moment().startOf("quarter"),!0),this.endPicker.picker.setMoment(moment(),!0);break;case"all":this.startPicker.find("input").val("").attr("placeholder","Before").change(),this.endPicker.picker.setMoment(moment(),!0)}this.trigger("change:range"),this.$el.trigger("change:range"),this.trigger("change"),this.$el.trigger("change")}}),Suit.Components.registerComponent("DateRange"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Graph=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]),nv.dev=!1,this.size=a.size||"tiny",this.data=a.data||[],this.baseColor=a.baseColor||"blue",this.isWidget=_.isUndefined(a.isWidget)?!1:!!a.isWidget,this.color=this.generateColors(),this.height=a.height||100,this.margin=_.isUndefined(a.margin)?{}:a.margin,this.showXAxis=_.isUndefined(a.showXAxis)?!0:!!a.showXAxis,this.showYAxis=_.isUndefined(a.showYAxis)?!0:!!a.showYAxis,this.width=a.width||100,this.noData=_.isUndefined(a.noData)?"No Data":a.noData},className:function(){return"graph-set-"+this.type},colorsMap:{blue:[50,161,204],purple:[104,91,139],blueberry:[78,129,204],green:[64,168,128],lime:[107,178,107],yellow:[209,175,80],tangerine:[216,161,80],orange:[221,133,78],red:[200,70,60],lightestGrey:[247,247,247]},generateColor:function(a,b){return"rgba("+a[0]+","+a[1]+","+a[2]+","+Math.round(100*b)/100+")"},generateColors:function(){var a=[],b=this.colorsMap[this.baseColor],c=1;if(this.isWidget)a="stacked-areagraph"===this.type||"areagraph"===this.type?["#e0e0e0",this.generateColor(b,1)]:[this.generateColor(b,1),this.generateColor(this.colorsMap.lightestGrey,1)];else{var d=this.data.length;"bargraph"===this.type&&this.data&&this.data[0].values?d=this.data[0].values.length:"bulletgraph"===this.type&&this.data&&this.data.measures&&(d=this.data.measures.length),this.options.hasAverage&&(d-=1);for(var e=0;d>e;e++)a.push(this.generateColor(b,c)),c-=.2}return this.options.hasAverage&&a.push("#F7F7F7"),a},afterRender:function(){this.chart=this.generateChart()},generateChart:function(){throw new Error("Needs to be rewritten")},formatters:{"":"defaultFormat",date:"dateFormat",datetime:"datetimeFormat",thousand:"thousandFormat",percentage:"percentageFormat",abbreviate:"abbreviateFormat",flatPercentage:"flatPercentageFormat"},getFormatter:function(a){return"function"==typeof a?a:this[this.formatters[a]]},defaultFormat:function(a){return a},abbreviateFormat:function(a){return Suit.Helpers.Formatters.abbreviateNumber(a)},datetimeFormat:function(a){return moment.unix(a).utc().format("YYYY/MM/DD HH:mm")},dateFormat:function(a){return moment.unix(a).utc().format("YYYY/MM/DD")},thousandFormat:function(a){return d3.format(",r")(a)},percentageFormat:function(a){return parseFloat(a).toFixed(2)+"%"},flatPercentageFormat:function(a){return parseInt(a)+"%"},events:{},template:JST["suit/components/graph"],type:"base-graph",data:[]}),Suit.Components.LineGraph=Suit.Components.Graph.extend({initialize:function(a){Suit.Components.Graph.prototype.initialize.apply(this,[a]),this.useInteractiveGuideline=a.useInteractiveGuideline||!0,this.showLegend=a.showLegend||!1,this.xAxisLabel=a.xAxisLabel||"Date",this.xAxisFormat=a.xAxisFormat||"date",this.yAxisLabel=a.yAxisLabel||"Impressions",this.yAxisFormat=a.yAxisFormat||"thousand",this.tooltips=a.tooltips||!1,this.minY=_.isUndefined(a.minY)?0:a.minY,this.maxY=_.isUndefined(a.maxY)?"auto":a.maxY,this.interactive=_.isUndefined(a.interactive)?!0:a.interactive},type:"linegraph",generateChart:function(){var a=this._minMaxValues(this.data),b=nv.models.lineChart().margin(this.margin).useInteractiveGuideline(this.useInteractiveGuideline).showLegend(this.showLegend).color(this.color).height(this.height).width(this.width).showYAxis(this.showYAxis).showXAxis(this.showXAxis).tooltips(this.tooltips);b.xAxis.tickValues(function(a){var b=a[0].values,c=b.length,d=[b[0].x,b[Math.floor(c/2)].x,b[c-1].x];return d}).axisLabel(this.xAxisLabel).tickFormat(this.getFormatter(this.xAxisFormat)),b.yAxis.axisLabel(this.yAxisLabel).tickFormat(this.getFormatter(this.yAxisFormat)),"auto"!==this.minY&&"auto"!==this.maxY?b.forceY([this.minY,this.maxY]):"auto"!==this.minY?b.forceY([this.minY,a.y.max]):"auto"!==this.maxY&&b.forceY([a.y.min,this.maxY]);
var c=this.data,d=d3.select(this.el).append("svg").datum(c).call(b);return this.interactive===!1&&d.selectAll("circle").remove(),nv.addGraph(function(){return b}),b},_minMaxValues:function(a){var b=_.flatten(_.pluck(a,"values")),c=_.pluck(b,"y"),d=_.pluck(b,"x");return{x:{min:Math.min.apply(null,d),max:Math.max.apply(null,d)},y:{min:Math.min.apply(null,c),max:Math.max.apply(null,c)}}}}),Suit.Components.PieChart=Suit.Components.Graph.extend({initialize:function(a){Suit.Components.Graph.prototype.initialize.apply(this,[a]),this.showLabels=this.options.showLabels||!1,this.labelType=this.options.labelType||"percent",this.donut=this.options.donut||!1,this.donutRatio=this.options.donutRatio||.4,this.showLegend=this.options.showLegend||!1,this.tooltips=this.options.tooltips||!1},type:"piegraph",generateChart:function(){var a=this,b=nv.models.pieChart().x(function(a){return a.label}).y(function(a){return a.value}).margin(a.margin).showLabels(a.showLabels).labelThreshold(.01).labelType(a.labelType).donut(a.donut).donutRatio(a.donutRatio).width(a.width).height(a.height).showLegend(a.showLegend).tooltips(a.tooltips);_.isUndefined(a.color)||b.color(a.color);var c=a.data;return d3.select(a.el).append("svg").datum(c).transition().duration(300).call(b),nv.addGraph(function(){return b}),b}}),Suit.Components.BarGraph=Suit.Components.Graph.extend({initialize:function(a){Suit.Components.Graph.prototype.initialize.apply(this,[a]),this.hasAverage=this.options.hasAverage||!1,this.staggerLabels=this.options.staggerLabels||!1,this.transitionDuration=this.options.transitionDuration||350,this.showValues=this.options.showValues||!1,this.tooltips=this.options.tooltips||!1,this.xAxisFormat=this.options.xAxisFormat||"",this.yAxisFormat=this.options.yAxisFormat||"abbreviate"},type:"bargraph",generateChart:function(){var a,b=this;return nv.addGraph(function(){a=nv.models.discreteBarChart().x(function(a){return a.label}).y(function(a){return a.value}).showValues(b.showValues).width(b.width).height(b.height).staggerLabels(b.staggerLabels).transitionDuration(b.transitionDuration).tooltips(b.tooltips).showYAxis(b.showYAxis).showXAxis(b.showXAxis),_.isUndefined(b.color)||a.color(b.color),a.xAxis.tickFormat(b.getFormatter(b.xAxisFormat)),a.yAxis.tickFormat(b.getFormatter(b.yAxisFormat));var c=b.data,d=d3.select(b.el).append("svg").datum(c).call(a);if(b.hasAverage){var e=_.max(b.data[0].values,function(a){return a.value}),f=b.data[0].values[b.data[0].values.length-1],g=a.height()-a.margin().bottom-a.margin().top,h=0,i=0,j=d.selectAll(".nv-barsWrap .nv-series-0 g");if(f&&f.value&&e&&e.value&&j.length>0&&j[0].length>0){h=f.value*g/e.value,i=g-h,b.$el.find(".nv-barsWrap .nv-series-0 g").last().remove();var k=d.select(".nv-barsWrap .nv-series-0").insert("g",":first-child");k.append("rect").attr("width","100%").attr("height",h).attr("x",1).attr("y",i).attr("fill","#F7F7F7"),k.append("text").text("AVG").attr("x",200).attr("y",230).attr("fill","#313233")}}return a}),a}}),Suit.Components.BulletGraph=Suit.Components.Graph.extend({initialize:function(a){Suit.Components.Graph.prototype.initialize.apply(this,[a])},type:"bulletgraph",generateChart:function(){var a=this,b=nv.models.bulletChart().color(a.color).margin({right:15}).tooltipContent(function(a,b,c){return"<p>"+c+"%</p>"}).width(a.width).height(a.height);b.tickFormat(a.getFormatter("flatPercentage"));var c=a.data;return d3.select(a.el).append("svg").datum(c).transition().attr("width",a.width).attr("height",a.height).call(b),nv.addGraph(function(){return b}),b}}),Suit.Components.StackedAreaGraph=Suit.Components.Graph.extend({initialize:function(a){Suit.Components.Graph.prototype.initialize.apply(this,[a]),this.useInteractiveGuideline=this.options.useInteractiveGuideline||!1,this.xAxisLabel=this.options.xAxisLabel||"",this.xAxisFormat=this.options.xAxisFormat||"default",this.yAxisLabel=this.options.yAxisLabel||"",this.yAxisFormat=this.options.yAxisFormat||"default",this.tooltips=this.options.tooltips||!1,this.baseLine=this.options.baseLine||!1,this.width=this.options.width,this.height=this.options.height,this.margin=this.options.margin||{left:10,right:15,top:0,bottom:0},this.tooltipContent=this.options.tooltipContent,this.rightAlignYAxis=this.options.rightAlignYAxis||!1},type:"stacked-areagraph",generateChart:function(){var a=this,b=nv.models.stackedAreaChart().x(function(a){return a[0]}).y(function(a){return a[1]}).width(a.width).height(a.height).margin(this.margin).useInteractiveGuideline(a.useInteractiveGuideline).rightAlignYAxis(this.rightAlignYAxis).transitionDuration(500).interactive(!0).showLegend(!1).showControls(!1).showYAxis(a.showYAxis).showXAxis(a.showXAxis).noData(a.noData).tooltips(a.tooltips);_.isUndefined(a.tooltipContent)||b.tooltipContent(a.tooltipContent),_.isUndefined(a.color)||b.color(a.color),b.xAxis.tickValues(function(a){var b=a[0].values,c=b.length,d=[b[0][0],b[Math.floor(c/3)][0],b[Math.floor(2*c/3)][0],b[c-1][0]];return d}).tickFormat(a.getFormatter(a.xAxisFormat)),b.yAxis.tickFormat(a.getFormatter(a.yAxisFormat));var c=a.data;d3.select(a.el).append("svg").datum(c).transition().call(b);var d=d3.select(".nv-series-0").insert("g",":first-child");if(a.baseLine){var e=(b.width()-b.margin().left-b.margin().right)*a.baseLine;d.append("rect").attr("width","1").attr("height",100).attr("x",e).attr("y",0).attr("stroke","#313233")}return nv.addGraph(function(){return b}),b}}),Suit.Components.AreaGraph=Suit.Components.Graph.extend({initialize:function(a){Suit.Components.Graph.prototype.initialize.apply(this,[a]),this.baseLine=this.options.baseLine||!1},type:"areagraph",generateChart:function(){var a=this,b={left:10,right:15,top:0,bottom:0},c=a.width-b.left-b.right,d=a.height-b.top-b.bottom,e=a.data,f=d3.scale.linear().domain([d3.min(e,function(a){return d3.min(a.values,function(a){return a[0]})}),d3.max(e,function(a){return d3.max(a.values,function(a){return a[0]})})]).range([0,c]),g=d3.scale.linear().domain([d3.min(e,function(a){return d3.min(a.values,function(a){return a[1]})}),d3.max(e,function(a){return d3.max(a.values,function(a){return a[1]})})]).range([d,b.top]),h=d3.select(a.el).append("svg"),i=d3.svg.area().x(function(a){return f(a[0])+b.left}).y0(d).y1(function(a){return g(a[1])});if(_.each(e,function(b,c){h.append("path").datum(b.values).attr("class","area").attr("d",i).style("fill",function(){return a.color[c]}).style("opacity",1)}),a.baseLine){var j=d3.select("svg").insert("g"),k=c*a.baseLine+10;j.append("rect").attr("width","1").attr("height",100).attr("x",k).attr("y",0).attr("stroke","#313233")}}}),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Modal=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]),this.size="",this.persistent=!1,_.isUndefined(a)||(_.isUndefined(a.view)||this.appendView(a.view),_.isUndefined(a.size)||"large"!==a.size&&"small"!==a.size||this.$el.addClass(a.size),_.isUndefined(a.persistent)||(this.persistent=a.persistent)),this.overlay=$('<div class="suit-modal-overlay"></div>');var b=this;this.persistent===!1&&this.overlay.bind("click",function(a){a.target===this&&b.close()}),this.listenTo(this,"beforeClose",this.resetView),Suit.Components.Modal.currentModals.push(this),Suit.Components.Modal.currentModals=_.uniq(Suit.Components.Modal.currentModals),this.show()},template:function(){return""},className:"suit-modal",events:{"click .close":"closeModal"},closeModal:function(a){a.preventDefault(),this.close()},show:function(){var a=this.$el,b=1e3+2*$(".suit-modal").length;this.overlay.css("z-index",b),b++,a.css("z-index",b),$("body").css("overflow","hidden"),$("body").append(this.overlay),a.hide(),this.overlay.append(this.el),a.fadeIn(200)},resetView:function(){Suit.Components.Modal.currentModals.splice(Suit.Components.Modal.currentModals.indexOf(this),1),$("body").css("overflow","auto"),this.overlay.unbind("click"),this.overlay.remove(),App.mainView.$el.removeClass("blur")}}),Suit.Components.Modal.currentModals=[],Suit.Components.Modal.closeAll=function(){_.each(Suit.Components.Modal.currentModals,function(a){a.close()})},_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.MultiSelect=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]);var b=this.cid;$(document).on("click."+b,function(a){_.isUndefined(a.target.className)||"multi-select-counter-row"!==a.target.className&&"ms-checkbox"!==a.target.className&&$(".multi-select-options").hide()}),this.on("onClose",function(){$(document).off("click."+b)})},events:{'click input[type="checkbox"]':"updateCounter","click .multi-select-counter-row":"toggleOptions","click .icon":"toggleOptions"},toggleOptions:function(a){a.preventDefault(),a.stopPropagation();var b=this.$el;b.attr("disabled")||b.find(".multi-select-options").toggle()},updateCounter:function(){var a=this.$el,b=a.find("input:checkbox:checked").length;a.find(".multi-select-counter").html(b)}}),Suit.Components.registerComponent("MultiSelect"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Slider=Suit.Component.extend({initialize:function(){Suit.Component.prototype.initialize.apply(this,this.options);var a=this.$el;a.attr("id",this.cid);var b={disabled:a.attr("data-disabled")||!1,horizontal:a.attr("data-horizontal")||!0,vertical:a.attr("data-vertical")||!1,x:a.attr("data-x")||0,y:a.attr("data-y")||0,steps:a.attr("data-steps")||0,snap:a.attr("data-snap")||!1,slide:a.attr("data-slide")||!0,loose:a.attr("data-loose")||!1,top:a.attr("data-top")||0,bottom:a.attr("data-bottom")||0,left:a.attr("data-left")||0,right:a.attr("data-right")||0,callback:this.callback,animationCallback:this.animationCallback,handleClass:a.attr("data-handleClass")||"handle"};this.slider=new Dragdealer(this.cid,b)},callback:function(a,b){var c=$(this.wrapper).data("view");c.trigger("change",a,b)},animationCallback:function(a,b){var c=$(this.wrapper).data("view");c.trigger("slide",a,b)}}),Suit.Components.registerComponent("Slider"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.SuitTab=Suit.Component.extend({initialize:function(){Suit.Component.prototype.initialize.apply(this,this.options)},events:{"click .suit-tab-link":"switchTab"},switchTab:function(a){this.$el.find(".suit-tab-link").removeClass("active"),$(a.currentTarget).addClass("active")}}),Suit.Components.registerComponent("SuitTab"),Suit.Components=Suit.Components||{},Suit.Components.Table=Suit.Component.extend({events:{"click th a.sortable":"_sortTable"},initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]),this.$thead=this.find("thead").first(),this.$tbody=this.find("tbody").first();var b=this.collection instanceof Suit.Collection?"collection.models":"collection";this.$tbody.find("tr").first().attr("suit-each-row",b),this.listenTo(this.collection,"sort",this._updateHeaders)},beforeClose:function(){_.has(this.options,"infiniteScroll")&&this._teardownInfiniteScroll()},afterRender:function(){_.has(this.options,"infiniteScroll")&&this._setupInfiniteScroll(),this.collection.sort()},_updateHeaders:function(){var a,b=this;_.each(this.find("th a.sortable"),function(c){a=$(c),b.collection.sortBy===a.attr("data-sort-by")?a.addClass("active "+b.collection.sortOrder):(a.data("current-sort-order",!1),a.removeClass("active asc desc"))})},_setupInfiniteScroll:function(){this.enableInfiniteScroll=!0,this._fetchingNextPage=!1;var a,b,c,d=$('<div class="infinite-scroll"><div class="infinite-scroll-container"></div></div>');d.css({position:"relative"}).find(".infinite-scroll-container").css({"overflow-y":"scroll"}),_.has(this.options,"stickyHeaders")&&(this._stickyHeaders=!0),this.$el.attr("height")&&(this.options.heightRestricted=!0,d.find(".infinite-scroll-container").css({height:this.$el.attr("height")})),this.$el.wrap(d),this.$thead.find("tr").first().children().each(function(c,d){b=$(d),a=b.height(),b.width(b.width())}),c=$("<table/>"),c.height(a),this.$newThead=this.$thead.clone(),this.$newThead.find("a.sortable").on("click",_.bind(this._sortTable,this)),this.$el.closest(".infinite-scroll").prepend(this.$newThead),this.$newThead.wrap(c),this.$thead.find("a.sortable").removeClass("sortable"),this.$thead.css("visibility","hidden"),this.$thead.find("th").css({"line-height":"0px",height:"0px",border:"0px"}),this.$scrollingView=this.$el.closest(".infinite-scroll-container"),this.$loader=$('<div class="infinite-scroll-loader"/>').css({position:"relative",height:100}),this.$scrollingView.append(this.$loader),this.$loader.hide(),this.el=this.$el.closest(".infinite-scroll")[0],this.$el=$(this.el),this.options.heightRestricted?this.$scrollingView.on("scroll",_.bind(this._scrollViewScrolled,this)):(this.__windowScrolled=_.bind(this._windowScrolled,this),this.$window=$(window),this.$window.on("scroll",this.__windowScrolled))},_teardownInfiniteScroll:function(){this.$newThead.find("a.sortable").off("click"),this.options.heightRestricted?this.$scrollingView.off("scroll"):(this.$window.off("scroll",this.__windowScrolled),delete this.__windowScrolled,delete this.$window)},_removeInfiniteLoader:function(){this.parent.removeLoader(".infinite-scroll-loader"),this.find(".infinite-scroll-loader").hide(),this._fetchingNextPage=!1},_sortTable:function(a){a.preventDefault();var b,c,d=$(a.target),e=d.data("default-sort"),f=d.data("sort-by");"asc"===d.data("current-sort-order")?e="desc":"desc"===d.data("current-sort-order")&&(e="asc"),d.data("current-sort-order",e),d.removeClass("active asc desc"),d.addClass("active "+e),this.collection.sortBy=f,this.collection.sortOrder=e,_.has(this.options,"infiniteScroll")?(this.collection.reset([]),this.trigger("table:sort",this.collection)):this.collection.sort(),b=d.attr("href"),c=-1===b.indexOf("?")?b+"?":b,c+=$.param({sortBy:f,sortOrder:e}),Backbone.history.navigate(c)},_windowScrolled:function(a){if(this._stickyHeaders&&this._stickHeaders(),this._fetchingNextPage||!this.enableInfiniteScroll)return a.preventDefault(),void a.stopPropagation();var b=this.$el.height()+this.$el.offset().top-this.$window.height()-100;this.$window.scrollTop()>=b&&this._fetchingNextPage===!1&&(a.preventDefault(),this._next())},_stickHeaders:function(){var a=this.$newThead.closest("table");this.$window.scrollTop()>this.$newThead.offset().top&&!a.data("isStuck")?(a.data("isStuck",!0),a.data("startingOffset",this.$newThead.offset().top),a.css({position:"fixed","z-index":50,width:a.width(),top:0})):a.data("isStuck")===!0&&this.$window.scrollTop()<a.data("startingOffset")&&(a.data("isStuck",!1),a.data("startingOffset",!1),a.css({position:"absolute"}))},_scrollViewScrolled:function(a){if(this._fetchingNextPage||!this.enableInfiniteScroll)return a.preventDefault(),void a.stopPropagation();var b=this.$scrollingView[0].scrollHeight-this.$scrollingView.height();this.$scrollingView.scrollTop()===b&&this._fetchingNextPage===!1&&(a.preventDefault(),this._next())},_next:function(){this._fetchingNextPage=!0,this.find(".infinite-scroll-loader").show(),this.parent.loader({selector:".infinite-scroll-loader",loaderSize:"small",tone:"light"}),this.trigger("table:next",this.collection,_.bind(this._removeInfiniteLoader,this))}}),Suit.Components.registerComponent("Table"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.TimePicker=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]);var b=this.$el.attr("class").split(" ")[1]||"blue";this.$el.hasClass("disabled")&&(b="blue",this.$el.find("a").addClass("disabled"),this.$el.find("input").attr("disabled","disabled")),this.$el.find("input").timepicker({className:b,timeFormat:"h:i A",noneOption:[{label:"11:59 PM",value:"11:59 PM"}]}),this.picker=this.$el.find("input")},events:{"click .time-picker-trigger":"showPicker","showTimepicker input":"toggleActive","hideTimepicker input":"toggleActive","timeFormatError input":"invalidTime"},showPicker:function(a){a.preventDefault(),$(a.currentTarget).hasClass("disabled")||this.$el.find("input").timepicker("show")},template:JST["suit/components/time_picker"],render:function(){return $("body").append(this.template(this)),this},toggleActive:function(){if(!this.noneAtBottom){var a=$("body ul.ui-timepicker-list").children(":first-child");$("body ul.ui-timepicker-list").append(a),this.noneAtBottom=!0}this.$el.toggleClass("active")},invalidTime:function(){this.picker.timepicker("setTime")}}),Suit.Components.registerComponent("TimePicker"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.ToggleButton=Suit.Component.extend({initialize:function(){Suit.Component.prototype.initialize.apply(this,this.options)},events:{click:"toggle"},toggle:function(){var a=this.$el;a.toggleClass("active"),a.trigger("toggled",a.hasClass("active")),this.trigger("toggled",a.hasClass("active"))}}),Suit.Components.registerComponent("ToggleButton"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Typeahead=Suit.Component.extend({initialize:function(a){Suit.Component.prototype.initialize.apply(this,[a]);var b=this.$el,c=b.attr("data-url"),d=b.attr("data-key")||"label",e=b.attr("data-limit")||10,f=_.isUndefined(b.attr("data-filter-lang"))?!1:b.attr("data-filter-lang"),g=this.options.local||void 0,h=this;if(b.attr("data-param")){var i=b.attr("data-param")+"=%QUERY",j=c.split("?");c=j[0],j[1]&&(i+="&"+j[1]),c=c+"?"+i}e&&(c=c+"&limit="+e),b.attr("id",this.cid),this.engine=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace(d),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:c,filter:function(a){return f&&(a=_.reject(a,function(a){return _.contains(App.Models.Label.languageArray,a.id)})),a}},local:g,limit:e,rateLimitWait:100}),this.engine.initialize(),$("#"+this.cid).typeahead(null,{name:"name",displayKey:d,source:h.engine.ttAdapter()}),$("#"+this.cid).keypress(function(a){13===a.which&&$(this).trigger("typeahead:selected")})}}),Suit.Components.registerComponent("Typeahead"),_.has(Suit,"Components")||(Suit.Components={}),Suit.Components.Video=Suit.Component.extend({initialize:function(){Suit.Component.prototype.initialize.apply(this,this.options);var a=this,b=this.$el;b.attr("id",this.cid);var c=document.getElementById(this.cid);c&&(this.video=videojs(c,{controls:!0,autoplay:!1,preload:"auto",techOrder:["flash","html5"]})),this.isDisposed=!1,this.listenTo(this,"onClose",function(){a.video&&!a.isDisposed&&(a.video.dispose(),a.isDisposed=!0)})}}),videojs.options.flash.swf="bower_components/videojs/dist/video-js/video-js.swf",Suit.Components.registerComponent("Video"),function(a){"use strict";a.configure({prefix:"suit",handler:function(a,b,c){if(c.model instanceof Suit.Model)return this.apply(c.model,[]);var d=$(a),e=d.val(),f=[b,a];if(d.is(":input")){var g=b.charCode||b.keyCode;e+="keypress"===b.type?String.fromCharCode(g):"",f.unshift(e)}this.apply(c.model,f)}})}(window.rivets),function(a,b){"use strict";b(a.rivets,a.Backbone)}(this,function(a){"use strict";function b(a,b){for(b=b.split(":");b.length>1;)a=a.get(b.shift());var c=b.shift();if(c.indexOf(".")>0){if(c=c.split("."),c.length>2)throw new Error('Cannot access properties of object on relation with "."');a=a.get(c[0]),c=c[1]}return{model:a,key:c}}function c(a,b,c){return _.isFunction(a[b])?a[b](c):(a[b]=c,c)}function d(a,d,e){var f=b(a,d);return a=f.model,2===arguments.length?a instanceof h?a.get(f.key):_.result(a,f.key):a instanceof h?a.set(f.key,e):c(a,f.key,e)}function e(a){return function(c,d,e){if(!(c instanceof h))return void c[a]("add remove reset",e);var f=b(c,d),g=f.model.get(f.key);g instanceof i?g[a]("add remove reset",e):f.model[a]("change:"+f.key,e)}}function f(a,b){if(a instanceof i)return _.result(a,b);var c=d(a,b);return c}function g(a,b,e){return a instanceof i?c(a,b,e):d(a,b,e)}var h=Suit.Model,i=Suit.Collection;a.adapters[":"]={subscribe:e("on"),unsubscribe:e("off"),read:f,publish:g}}),function(){"use strict";_.extend(window.rivets.formatters,_.clone(Suit.Helpers.Formatters))}(),_.isUndefined(window.jasmine)&&$(function(){$("body").prepend(App.mainView.render().el),App.mainRouter=new App.Routers.Main,_.each(App.Routers,function(a,b){new App.Routers[b]}),Backbone.history.start({pushState:!1})});